{% extends 'admin_index.html' %}
{% load static %}

{% block content %}
<div class="container py-4">

  <!-- Title + Back Button -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold page-title">Order Details</h2>
    <a href="{% url 'admin_view_orders' %}" class="btn btn-back">
      ← Back
    </a>
  </div>

  <!-- Order Summary -->
  <div class="custom-card mb-4">
    <h5 class="section-title">Order Information</h5>

    <div class="row">
      <div class="col-md-6">
        <p><strong>Order ID:</strong> {{ order.id }}</p>
        <p><strong>User:</strong> {{ order.user.username }}</p>
        <p><strong>Order Date:</strong> {{ order.order_date|date:"d M Y, h:i A" }}</p>
      </div>

      <div class="col-md-6">
        <p><strong>Status:</strong>
          {% if order.status == 'order on the way' %}
            <span class="status-badge bg-info-custom">{{ order.status }}</span>
          {% elif order.status == 'order delivered' %}
            <span class="status-badge bg-success-custom">{{ order.status }}</span>
          {% elif order.status == 'order cancelled' %}
            <span class="status-badge bg-danger-custom">{{ order.status }}</span>
          {% elif order.status == 'order placed' %}
            <span class="status-badge bg-primary-custom">{{ order.status }}</span>
          {% else %}
            <span class="status-badge bg-secondary-custom">{{ order.status }}</span>
          {% endif %}
        </p>

        <p><strong>Total Amount:</strong> ₹{{ order.total_amount }}</p>

        <p><strong>Delivery Agent:</strong>
          {% if order.assigned_agent %}
            {{ order.assigned_agent.username }}
          {% else %}
            <span class="text-muted">Not assigned</span>
          {% endif %}
        </p>

        <p><strong>Estimated Delivery:</strong>
          {% if order.estimated_delivery_date %}
            {{ order.estimated_delivery_date|date:"d M Y, h:i A" }}
          {% else %}
            <span class="text-muted">Not set</span>
          {% endif %}
        </p>
      </div>
    </div>
  </div>

  <!-- Items Table -->
  <div class="custom-card">
    <h5 class="section-title">Items in Order</h5>

    <div class="table-responsive">
      <table class="table table-bordered table-striped text-center table-hover">
        <thead class="table-header">
          <tr>
            <th>#</th>
            <th>Product</th>
            <th>Qty</th>
            <th>Price (₹)</th>
            <th>Total (₹)</th>
          </tr>
        </thead>

        <tbody>
          {% for item in items %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td class="text-start ps-4 fw-semibold">{{ item.product.name }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.product_price }}</td>
            <td class="fw-bold">{{ item.total_price }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-muted py-3">No items found for this order.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>

<style>
/* Main heading */
.page-title {
  color: #0077b6;
  font-size: 28px;
}

/* Back Button Design */
.btn-back {
  background: #023e8a;
  color: white;
  padding: 6px 16px;
  border-radius: 8px;
  transition: 0.2s;
  font-weight: 500;
}
.btn-back:hover {
  background: #03045e;
  color: #fff;
}

/* Card Design */
.custom-card {
  background: #ffffff;
  border-radius: 15px;
  padding: 25px;
  box-shadow: 0px 4px 15px rgba(0,0,0,0.08);
  border-left: 5px solid #0096c7;
}

/* Section Title */
.section-title {
  color: #0096c7;
  font-weight: 600;
  margin-bottom: 20px;
  font-size: 20px;
}

/* Status badge colors */
.status-badge {
  padding: 5px 12px;
  border-radius: 12px;
  font-size: 13px;
  font-weight: 500;
  text-transform: capitalize;
}

.bg-info-custom { background: #caf0f8; color: #023e8a; }
.bg-success-custom { background: #d8f3dc; color: #1b4332; }
.bg-danger-custom { background: #ffe5e5; color: #d00000; }
.bg-primary-custom { background: #e0f7ff; color: #0077b6; }
.bg-secondary-custom { background: #f1f1f1; color: #6c757d; }

/* Table Header */
.table-header {
  background: #0096c7;
  color: white;
  font-size: 16px;
}

/* Table Row Hover */
table.table-hover tbody tr:hover {
  background: #f1f9ff;
  cursor: pointer;
}

/* Custom text primary */
.text-primary {
  color: #0077b6 !important;
}
</style>

{% endblock %}
